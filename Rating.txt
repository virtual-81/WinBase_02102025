Расчёт баллов рейтинга для одного результата:

Result:= 0;    // инициализация
// упражнение может быть двух типов - табличное или произвольное (любое текстовое название)
// для произвольного упражнения рейтинг не считается
ev:= Event;
if ev= nil then   // проверяем, если упражнение произвольное, то ничего не делаем
  exit;
// то же самое для соревнования
ch:= Championship;
if ch= nil then
  exit;
// упражнение и соревнование ненулевые, поэтому можно посчитать рейтинг
// в каждом упражнении есть определённый результат, ниже которого рейтинг не начисляется
if fCompetition< ev.MinRatedResult then
	Result:= 0
else
	begin
    // за занятое место основной рейтинг дается по таблице
    // эта таблица - атрибут соревнования(!!!)
/*
     таблица немного сложная: в каждом соревновании есть своя таблица для всех упражнений
     по сути это подобие 3-мерной матрицы {соревнование;упражнение;место}
     пример: {Олимпийские игры;ВП-12;1} = 0, но {Чемпионат мира;ВП-12;1} = 3000
*/
    if fRank> 0 then
      Result:= Result+ch.GetRating (self);

    // далее добавляется рейтинг за показанный результат
    // таблица этих бонусов - атрибут упражнения(!!!)
    fr._int:= fCompetition;
    fr._frac:= 0;
		Result:= Result+ev.GetBonus (fr);
		// далее посчитанный рейтинг "убавляется" с течением времени
		// у каждого соревнования есть свой период удержания рейтинга и период истечения (в месяцах!)
		// в течение периода удержания ничего не меняется
		// при расчёте принимается усреднённый месяц, равный 30.5 дням
		interval:= trunc (Data.RatingDate)-trunc (Date);
		if (interval< 0) or (interval>= ch.Period * 30.5) then
			Result:= 0
		else
			begin
				if interval> ch.RatingHold * 30.5 then
					Result:= round (Result*(1-(interval-ch.RatingHold*30.5)/((ch.Period-ch.RatingHold)*30.5)));
			end;
	end;
